{
  "resourceType": "Measure",
  "id": "age-stratified-example",
  "meta": {
    "profile": [ "http://hl7.org/fhir/uv/cqm/StructureDefinition/cqm-computablemeasure" ]
  },
  "contained": [ {
    "resourceType": "Library",
    "id": "effective-data-requirements",
    "extension": [ {
      "url": "http://hl7.org/fhir/StructureDefinition/cqf-directReferenceCode",
      "valueCoding": {
        "system": "http://terminology.hl7.org/CodeSystem/iso-8601-derived-periods",
        "code": "P10Y--P15Y",
        "display": "10-14 years"
      }
    }, {
      "url": "http://hl7.org/fhir/StructureDefinition/cqf-directReferenceCode",
      "valueCoding": {
        "system": "http://terminology.hl7.org/CodeSystem/iso-8601-derived-periods",
        "code": "P15Y--P20Y",
        "display": "15-19 years"
      }
    }, {
      "url": "http://hl7.org/fhir/StructureDefinition/cqf-directReferenceCode",
      "valueCoding": {
        "system": "http://terminology.hl7.org/CodeSystem/iso-8601-derived-periods",
        "code": "P20Y--P9999Y",
        "display": "20+ years"
      }
    }, {
      "url": "http://hl7.org/fhir/StructureDefinition/cqf-logicDefinition",
      "extension": [ {
        "url": "libraryName",
        "valueString": "AgeStratificationExample"
      }, {
        "url": "name",
        "valueString": "Initial Population"
      }, {
        "url": "statement",
        "valueString": "define \"Initial Population\":\n  exists (\n    [Encounter] E\n      where E.period during \"Measurement Period\"\n  )"
      }, {
        "url": "displaySequence",
        "valueInteger": 0
      } ]
    }, {
      "url": "http://hl7.org/fhir/StructureDefinition/cqf-logicDefinition",
      "extension": [ {
        "url": "libraryName",
        "valueString": "AgeStratificationExample"
      }, {
        "url": "name",
        "valueString": "By Age"
      }, {
        "url": "statement",
        "valueString": "/*\nBy Patient Age as of the start of the Measurement Period\nAge (10-14, 15-19, 20+)\n*/\ndefine \"By Age\":\n  case\n    when AgeInYearsAt(start of \"Measurement Period\") in Interval[10, 14] then \"P10Y--P15Y\"\n    when AgeInYearsAt(start of \"Measurement Period\") in Interval[15, 19] then \"P15Y--P20Y\"\n    when AgeInYearsAt(start of \"Measurement Period\") >= 20 then \"P20Y--P9999Y\"\n    else null\n  end"
      }, {
        "url": "displaySequence",
        "valueInteger": 1
      } ]
    }, {
      "url": "http://hl7.org/fhir/StructureDefinition/cqf-logicDefinition",
      "extension": [ {
        "url": "libraryName",
        "valueString": "FHIRHelpers"
      }, {
        "url": "name",
        "valueString": "ToInterval"
      }, {
        "url": "statement",
        "valueString": "/*\n@description: Converts the given [Period](https://hl7.org/fhir/datatypes.html#Period)\nvalue to a CQL DateTime Interval\n@comment: If the start value of the given period is unspecified, the starting\nboundary of the resulting interval will be open (meaning the start of the interval\nis unknown, as opposed to interpreted as the beginning of time).\n*/\ndefine function ToInterval(period FHIR.Period):\n    if period is null then\n        null\n    else\n        if period.\"start\" is null then\n            Interval(period.\"start\".value, period.\"end\".value]\n        else\n            Interval[period.\"start\".value, period.\"end\".value]"
      }, {
        "url": "displaySequence",
        "valueInteger": 2
      } ]
    } ],
    "name": "EffectiveDataRequirements",
    "status": "active",
    "type": {
      "coding": [ {
        "system": "http://terminology.hl7.org/CodeSystem/library-type",
        "code": "module-definition"
      } ]
    },
    "relatedArtifact": [ {
      "type": "depends-on",
      "display": "Library FHIRHelpers",
      "resource": "http://hl7.org/fhir/uv/cql/Library/FHIRHelpers|4.0.1"
    }, {
      "type": "depends-on",
      "display": "Code system ISO-8601-Derived Periods",
      "resource": "http://terminology.hl7.org/CodeSystem/iso-8601-derived-periods"
    } ],
    "parameter": [ {
      "name": "Measurement Period",
      "use": "in",
      "min": 0,
      "max": "1",
      "type": "Period"
    }, {
      "name": "Initial Population",
      "use": "out",
      "min": 0,
      "max": "1",
      "type": "boolean"
    }, {
      "name": "By Age",
      "use": "out",
      "min": 0,
      "max": "1",
      "type": "Coding"
    } ],
    "dataRequirement": [ {
      "type": "Encounter",
      "profile": [ "http://hl7.org/fhir/StructureDefinition/Encounter" ],
      "mustSupport": [ "period" ]
    }, {
      "type": "Patient",
      "profile": [ "http://hl7.org/fhir/StructureDefinition/Patient" ]
    } ]
  } ],
  "extension": [ {
    "url": "http://hl7.org/fhir/uv/cqm/StructureDefinition/cqm-populationBasis",
    "valueCode": "boolean"
  }, {
    "id": "effective-data-requirements",
    "url": "http://hl7.org/fhir/uv/crmi/StructureDefinition/crmi-effectiveDataRequirements",
    "valueCanonical": "#effective-data-requirements"
  } ],
  "url": "http://hl7.org/fhir/uv/cqm/Measure/age-stratified-example",
  "name": "MeasureAgeStratifiedExample",
  "title": "Measure Age Stratified Example",
  "status": "active",
  "experimental": true,
  "date": "2025-08-13",
  "publisher": "Clinical Quality Information Workgroup",
  "description": "A sample measure demonstrating age stratification using  age ranges represented as ISO-8601-Derived periods.",
  "library": [ "http://hl7.org/fhir/uv/cqm/Library/AgeStratificationExample" ],
  "scoring": {
    "coding": [ {
      "system": "http://terminology.hl7.org/CodeSystem/measure-scoring",
      "code": "cohort"
    } ]
  },
  "group": [ {
    "extension": [ {
      "url": "http://hl7.org/fhir/5.0/StructureDefinition/extension-Measure.group.linkId",
      "valueString": "primary"
    } ],
    "population": [ {
      "extension": [ {
        "url": "http://hl7.org/fhir/5.0/StructureDefinition/extension-Measure.group.population.linkId",
        "valueString": "primary-age-stratified-example-initial-population"
      } ],
      "code": {
        "coding": [ {
          "system": "http://terminology.hl7.org/CodeSystem/measure-population",
          "code": "initial-population"
        } ]
      },
      "criteria": {
        "language": "text/cql-identifier",
        "expression": "Initial Population"
      }
    } ],
    "stratifier": [ {
      "extension": [ {
        "url": "http://hl7.org/fhir/5.0/StructureDefinition/extension-Measure.group.stratifier.linkId",
        "valueString": "primary-age-stratified-example-stratification-1"
      }, {
        "url": "http://hl7.org/fhir/uv/cqm/StructureDefinition/cqm-valueSet",
        "valueCanonical": "http://hl7.org/fhir/uv/cqm/ValueSet/age-stratified-example"
      } ],
      "code": {
        "text": "Age Group"
      },
      "description": "Stratification by age groups represented as ISO-8601-Derived periods.",
      "criteria": {
        "language": "text/cql-identifier",
        "expression": "By Age"
      }
    } ]
  } ]
}